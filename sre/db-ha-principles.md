# 数据库高可用原理和实践

<!-- TOC -->

- [数据库高可用原理和实践](#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E8%B7%B5)
    - [定义](#%E5%AE%9A%E4%B9%89)
    - [数据库高可用系统的三大模块](#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%AB%98%E5%8F%AF%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%B8%89%E5%A4%A7%E6%A8%A1%E5%9D%97)
        - [网关模块](#%E7%BD%91%E5%85%B3%E6%A8%A1%E5%9D%97)
        - [高可用模块](#%E9%AB%98%E5%8F%AF%E7%94%A8%E6%A8%A1%E5%9D%97)
        - [副本同步模块](#%E5%89%AF%E6%9C%AC%E5%90%8C%E6%AD%A5%E6%A8%A1%E5%9D%97)
    - [通用方案](#%E9%80%9A%E7%94%A8%E6%96%B9%E6%A1%88)

<!-- /TOC -->
## 定义

高可用指服务的可用性，它主要是指**一个系统自动从故障中恢复并持续提供服务的能力**。

给不同的应用做高可用功能的难度不同，有状态的应用(数据库，存储系统 etc.)比较难做。

本文实现数据库高可用需要权衡的方面。


## 数据库高可用系统的三大模块

数据库要实现高可用功能，大致分为三个模块：

1. 网关模块
2. 高可用管理模块
3. 副本同步模块


### 网关模块

- 实现数据库客户端（连接DB的应用）访问透明。

> 这意味着当发生故障切换时，虽然主节点角色对应的数据库实例发生改变，但是客户端的数据库连接地址不会改变。通常的实现方式是VIP，DNS, proxy模式.

- 负载均衡
- 连接池
- 读写分离


### 高可用模块

- 健康检测: 巡检集群节点健康状态
- 故障切换：提供自动/手动方式进行故障切换的功能


### 副本同步模块

数据库内置一般提供同步功能。

同步方式分成三种，以下性能从低到高，可靠性（数据丢失概率）从高到低：

1. 同步方式
2. 半同步方式
3. 异步方式


## 通用方案



